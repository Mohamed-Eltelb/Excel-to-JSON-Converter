<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel to JSON Converter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="icon.png" type="image/x-icon">
    <style>
        .drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
        }

        .drop-area.highlight {
            border-color: #0d6efd;
            background-color: #f0f7ff;
        }

        #preview {
            max-height: 300px;
            overflow-y: auto;
        }

        .hidden {
            display: none;
        }

        .hidden {
            display: none;
        }

        #processingIndicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            width: 80%;
            max-width: 400px;
        }

        .drop-area {
            transition: all 0.3s ease;
        }

        /* Container spacing */
        #columnCheckboxes {
            display: flex;
            max-height: 300px;
            overflow: auto;
            flex-wrap: wrap;
            gap: 12px;
        }

        /* Hide native checkboxes */
        #columnCheckboxes .form-check-input {
            display: none;
        }

        /* Label as toggle button */
        #columnCheckboxes .form-check-label {
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            background-color: #e0e7ff;
            color: #1e3a8a;
            border: 2px solid #3b82f6;
            font-weight: 500;
            transition: all 0.3s ease;
            user-select: none;
            font-family: 'Segoe UI', sans-serif;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        #columnCheckboxes .form-check {
            padding-left: 0 !important;
        }

        /* Checked state styling */
        #columnCheckboxes .form-check-input:checked+.form-check-label {
            background-color: #3b82f6;
            color: white;
            border-color: #1d4ed8;
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
        }

        /* Hover effect */
        #columnCheckboxes .form-check-label:hover {
            background-color: #dbeafe;
        }

        .text-muted {
            color: #6c757d !important;
            text-align: center;
            width: 100%;
        }
    </style>
</head>

<body>
    <div class="container py-5">
        <h1 class="text-center mb-4">Excel to JSON Converter</h1>

        <div class="card shadow">
            <div class="card-body">
                <div id="dropArea" class="drop-area">
                    <h4>Drag & Drop Excel/CSV File Here</h4>
                    <p class="text-muted">or</p>
                    <input type="file" id="fileInput" class="form-control" accept=".xlsx,.xls,.csv">
                </div>

                <div class="row mt-3">
                    <div class="">
                        <div class="mb-3">
                            <label class="form-label">Options</label>
                            <!-- <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="camelCase" checked>
                                <label class="form-check-label" for="camelCase">Convert headers to camelCase</label>
                            </div> -->
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="prettyPrint" checked>
                                <label class="form-check-label" for="prettyPrint">Pretty print JSON</label>
                            </div>
                        </div>
                        <div class="mb-3" id="columnSelectionUI">
                            <fieldset class="p-3 border rounded">
                                <legend class="float-none w-auto px-2">Select Columns</legend>
                                <div class="d-flex gap-2 mb-2 justify-content-center d-none mb-4"
                                    id="selection-controls">
                                    <button id="selectAllBtn" class="btn btn-sm btn-outline-primary">Select All</button>
                                    <button id="deselectAllBtn" class="btn btn-sm btn-outline-secondary">Deselect
                                        All</button>
                                </div>
                                <div id="columnCheckboxes" class="">
                                    <p class="text-muted"> Select a file to see column options.</p>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="d-flex justify-content-center gap-2">
                            <button id="downloadBtn" class="btn btn-primary" disabled>Download JSON</button>
                            <button id="copyBtn" class="btn btn-secondary" disabled>Copy to Clipboard</button>
                            <button id="clearBtn" class="btn btn-outline-danger">Clear</button>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <label class="form-label">Preview</label>
                    <pre id="preview" class="bg-light p-3 rounded">No file selected</pre>
                </div>
            </div>
        </div>

        <div class="mt-4 text-center text-muted small">
            <p>Supports Excel (.xlsx, .xls) and CSV files. Data processing happens in your browser - your files are not
                uploaded to any server.</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>

</html>